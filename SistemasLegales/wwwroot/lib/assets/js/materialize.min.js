var chipsHandleEvents=!1,materialChipsDefaults={data:[],placeholder:"",secondaryPlaceholder:""};$(document).ready(function(){$(document).on("click",".chip .close",function(e){$(this).closest(".chips").data("initialized")||$(this).closest(".chip").remove()})}),$.fn.material_chip=function(e){var l=this;return this.$el=$(this),this.$document=$(document),this.SELS={CHIPS:".chips",CHIP:".chip",INPUT:"input",DELETE:".material-icons",SELECTED_CHIP:".selected"},"data"===e?this.$el.data("chips"):"options"===e?this.$el.data("options"):(this.$el.data("options",$.extend({},materialChipsDefaults,e)),this.init=function(){var i=0;l.$el.each(function(){var e=$(this);if(!e.data("initialized")){var t=e.data("options");(!t.data||!t.data instanceof Array)&&(t.data=[]),e.data("chips",t.data),e.data("index",i),e.data("initialized",!0),e.hasClass(l.SELS.CHIPS)||e.addClass("chips"),l.chips(e),i++}})},this.handleEvents=function(){var d=l.SELS;l.$document.on("click",d.CHIPS,function(e){$(e.target).find(d.INPUT).focus()}),l.$document.on("click",d.CHIP,function(e){$(d.CHIP).removeClass("selected"),$(this).toggleClass("selected")}),l.$document.on("keydown",function(e){if(!$(e.target).is("input, textarea")){var t,i=l.$document.find(d.CHIP+d.SELECTED_CHIP),a=i.closest(d.CHIPS),n=i.siblings(d.CHIP).length;if(i.length)if(8===e.which||46===e.which){e.preventDefault();var s=a.data("index");t=i.index(),l.deleteChip(s,t,a);var c=null;t+1<n?c=t:t!==n&&t+1!==n||(c=n-1),c<0&&(c=null),null!==c&&l.selectChip(s,c,a),n||a.find("input").focus()}else if(37===e.which){if((t=i.index()-1)<0)return;$(d.CHIP).removeClass("selected"),l.selectChip(a.data("index"),t,a)}else if(39===e.which){if(t=i.index()+1,$(d.CHIP).removeClass("selected"),n<t)return void a.find("input").focus();l.selectChip(a.data("index"),t,a)}}}),l.$document.on("focusin",d.CHIPS+" "+d.INPUT,function(e){$(e.target).closest(d.CHIPS).addClass("focus"),$(d.CHIP).removeClass("selected")}),l.$document.on("focusout",d.CHIPS+" "+d.INPUT,function(e){$(e.target).closest(d.CHIPS).removeClass("focus")}),l.$document.on("keydown",d.CHIPS+" "+d.INPUT,function(e){var t=$(e.target),i=t.closest(d.CHIPS),a=i.data("index"),n=i.children(d.CHIP).length;return 13===e.which?(e.preventDefault(),l.addChip(a,{tag:t.val()},i),void t.val("")):8!==e.keyCode&&37!==e.keyCode||""!==t.val()||!n?void 0:(l.selectChip(a,n-1,i),void t.blur())}),l.$document.on("click",d.CHIPS+" "+d.DELETE,function(e){var t=$(e.target),i=t.closest(d.CHIPS),a=t.closest(d.CHIP);e.stopPropagation(),l.deleteChip(i.data("index"),a.index(),i),i.find("input").focus()})},this.chips=function(e){var t="";e.data("options");e.data("chips").forEach(function(e){t+=l.renderChip(e)}),t+='<input class="input" placeholder="">',e.html(t),l.setPlaceholder(e)},this.renderChip=function(e){if(e.tag){var t='<div class="chip">'+e.tag;return e.image&&(t+=' <img src="'+e.image+'"> '),t+='<i class="material-icons close">close</i>',t+="</div>"}},this.setPlaceholder=function(e){var t=e.data("options");e.data("chips").length&&t.placeholder?e.find("input").prop("placeholder",t.placeholder):!e.data("chips").length&&t.secondaryPlaceholder&&e.find("input").prop("placeholder",t.secondaryPlaceholder)},this.isValid=function(e,t){for(var i=e.data("chips"),a=!1,n=0;n<i.length;n++)if(i[n].tag===t.tag)return void(a=!0);return""!==t.tag&&!a},this.addChip=function(e,t,i){if(l.isValid(i,t)){i.data("options");var a=l.renderChip(t);i.data("chips").push(t),$(a).insertBefore(i.find("input")),i.trigger("chip.add",t),l.setPlaceholder(i)}},this.deleteChip=function(e,t,i){var a=i.data("chips")[t];i.find(".chip").eq(t).remove(),i.data("chips").splice(t,1),i.trigger("chip.delete",a),l.setPlaceholder(i)},this.selectChip=function(e,t,i){var a=i.find(".chip").eq(t);a&&!1===a.hasClass("selected")&&(a.addClass("selected"),i.trigger("chip.select",i.data("chips")[t]))},this.getChipsElement=function(e,t){return t.eq(e)},this.init(),void(chipsHandleEvents||(this.handleEvents(),chipsHandleEvents=!0)))};